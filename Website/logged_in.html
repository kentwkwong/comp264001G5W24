<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
</head>
<html>
    <body>
        <a href="https://301242732.auth.ca-central-1.amazoncognito.com/logout?client_id=7bu7si89rrf21h6e117arjake0&logout_uri=http%3A%2F%2Flocalhost%3A8000%2Floggedout">Log out now</a>
        <br />
        <h1>Logged In!</h1>
        <form id="frm" enctype="application/x-www-form-urlencoded">
            Username: <label id="email">${email}</label>
            <input type="button" id="btn_upgrade" class="btn btn-primary" value="Upgrade"></input>
            <br />
            Tier: <label id="tier">${tier}</label>
            <br />
            <span id="message">upgrade message be shown here!</span>
            <br />
            <br />
            <br />
            Stock code:
            <input type="text" id="txt_input" value="" ></input>
            <input type="button" id="btn_search" class="btn btn-primary" value="Search"></input>
            <br />
            <span id="result">stock code analysis be shown here!</span>

        </form>
    </body>
</html>

<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script>
    $('#btn_upgrade').click(function(e){
        var email = $('#email').text();
        $.ajax({
            url: '/upgrade_user/' + email,
            type: "PUT",
            processData: false,
            contentType: "application/json; charset=UTF-8",
            data: JSON.stringify(email)
        }).done(function(data) {
            $('#message').text(data['message']);
            $('#tier').text(data['tier'])
        });
    });

    $('#btn_search').click(function(e){
        var stockcode = $('#txt_input').val();
        $.ajax({
            url: '/stockcode/' + stockcode,
            type: "PUT",
            contentType: "application/json; charset=UTF-8"
        }).done(function(data) {
            console.log('btn_search')
            console.log(data)
            $('#result').text(JSON.stringify(data))
        });
    });
</script>